{% extends "base.html" %}

{% block header %}
    {% block title %} {% endblock %}
{% endblock %}

{% block content %}
    <main>
        <!-- <div id="root"></div>
        <script type="text/babel" src="{{ url_for('static',filename='js/index.js') }}"></script> -->
       <script>
            var data = {{ data|tojson|safe }};
        </script>
        <div id='root' className='my-10 md:max-lg:flex content-start'></div>
        <script>
            import React from 'react';
        </script>
        <script type="text/babel">
            const rootElement = document.getElementById('root')
            console.log(data);

            class EntryForm extends React.Component {
                constructor(props) {
                    super(props);
                    this.state = {
                        topic: '',
                        entry: ''};
                    this.handleTopicChange = this.handleTopicChange.bind(this);
                    this.handleEntryChange = this.handleEntryChange.bind(this);
                    this.handleSubmit = this.handleSubmit.bind(this);
                }

                handleTopicChange(event) {
                    this.setState({topic: event.target.value});
                }

                handleEntryChange(event) {
                    this.setState({entry: event.target.value});
                }

                handleSubmit(event) {
                    alert('A name was submitted: ' + this.state.topic + ' entry: ' + this.state.entry);
                    event.preventDefault();
                    axios({
                        method: 'post',
                        url: "http://127.0.0.1:5000/list",
                        headers: {'content-type': 'application/json'},
                        data: {"topic": this.state.topic, "entry": this.state.entry}
                    }).then(result => {
                        console.log(result.data);
                    }).catch(error => {
                        console.log(error);
                    })
                }

                render() {
                    return (
                        <form className="py-3 px-2 bg-slate-100 rounded-2xl" onSubmit={this.handleSubmit}>
                            <h1 className="self-center text-center text-xl text-gray-700 text-center font-bold mb-4 mt-6">Enter Github Data</h1>
                            <div className="mb-6 mt-8">
                                <div className="py-2 px-5 ml-20 mr-20">
                                    <textarea cols="50" rows="14"  className="w-80 sm:w-90 text-base text-gray-700 placeholder-gray-600 border rounded-lg focus:shadow-outline" value={this.state.entry} onChange={this.handleEntryChange}></textarea>
                                </div>
                                <div className="self-center">
                                    <button className="self-center bg-blue-500 hover:bg-gray-400 text-white text-xl font-semibold py-4 px-20 rounded-lg"
                                        type="submit">Generate</button>
                                </div>
                            </div>
                        </form>
                    );
                }
            }

            class TeamList extends React.Component {
                render() {
                    return (
                    <div className="py-3 bg-slate-100 rounded-2xl ml-5 mx-5 px-10">
                            <h1 className="text-center text-xl text-gray-700 font-bold mb-6 mt-6 px-20 w-full">Team Members</h1>
                            <div class="my-8 select-none">
                                {this.props.listdata.map(item =>
                                        <button className="py-3 px-3 pb-2 pt-2.5 shadow-md no-underline rounded-full bg-slate-500 text-white font-sans font-semibold text-sm border-gray btn-primary hover:text-white hover:bg-slate-300 focus:outline-none active:shadow-none">{item.name}</button>
                            )}
                            </div>
                    </div>
                    );
                }
            }
            
            class Report extends React.Component {
                render() {
                    return (
                    <div className="py-3 bg-slate-100 rounded-2xl px-30 mb-10">
                        <h1 className="self-center text-center text-xl text-gray-700 text-center font-bold mb-6 mt-6 mx-20 px-20">Summary</h1>
                        <div className="mb-6 px-10">{this.props.summary}</div>
                        <div>
                            <ul className="w-full px-10">
                                {this.props.highlights.map(item =>
                                                           <li className="mb-3">
                                                                <h3 className="font-bold text-sm mb-1">{item.title}</h3>
                                                                <p>{item.description}</p>
                                                           </li>
                                )}
                            </ul>
                        </div>
                    </div>
                    );
                }
            }
            
            class EmptyEntryList extends React.Component {
                render() {
                    return (
                        <div className="mx-50 content-center mt-18 h-56 mb-20">
                            <div className="justify-center my-12 mx-40">
                                <h1 className="self-center text-4xl text-gray-700 text-center font-bold mb-10">Team Report</h1>
                                <div className="w-80">
                                    <div className="flex items-start mb-30">
                                        <EntryForm/>
                                        <TeamList listdata={data.team}/>
                                        <Report summary={data.report.summary} highlights={data.report.highlights}/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    );
                }
            };

            function App() {
                    return (
                        <div>
                            <EmptyEntryList/>
                        </div>
                    )
            }

            ReactDOM.render(<App/>, rootElement)
        </script>
    </main>
{% endblock %}
