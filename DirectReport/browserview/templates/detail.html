{% extends "base.html" %}
{% block header %}
    {% block title %} Home {% endblock %}
{% endblock %}
{% block content %}
    <main>
        <script>
            var data = {{ data|tojson|safe }};
        </script>
        <div id='root' class='md:max-lg:flex content-start'></div>
        <script type="text/babel">
            const rootElement = document.getElementById('root')
            class Entry extends React.Component {

                state = {
                    isEditting: false
                };

                renderAuthButton = () => {
                    if (this.state.isEditting) {
                        return <textarea rows="4" className="focus:shadow-soft-primary-outline min-h-unset text-sm leading-5.6 ease-soft block h-auto w-full appearance-none rounded-lg border border-solid border-gray-300 bg-white bg-clip-padding px-3 py-2 font-normal text-gray-700 outline-none transition-all placeholder:text-gray-500 focus:border-fuchsia-300 focus:outline-none">{this.props.itemdata.message}</textarea>
                    } else {
                        return <p className="mt-5 px-40 text-xl content-center text-gray-500 border-0">{this.props.itemdata.message}</p>
                    }
                }

                renderTopicElement = () => {
                    if (this.state.isEditting) {
                        return <input className="mx-80 px-40 content-center" type="text" value={this.props.itemdata.topic}></input>
                    } else {
                        return <h1 className="mb-5 text-3xl text-gray-800 text-center content-center font-bold">{this.props.itemdata.topic}</h1>
                    }
                }

                render() {
                    return (
                        <div className="mx-60 px-40 content-center mt-20 my-8 h-56">
                            {this.renderTopicElement()}
                            <h2 className="my-5 px-40 text-lg text-gray-500 font-semibold">{'Created on: ' + this.props.itemdata.created_at}</h2>
                            {this.renderAuthButton()}
                            <div className="mt-14 flex content-center items-center justify-center gap-x-24">
                                <button className="mt-50 rounded-full bg-blue-600 px-14 py-5 text-lg text-white shadow-lg font-semibold text-center hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500" onClick={this.click}>Edit</button>
                                <a href={"/delete/" + this.props.itemdata.uuid} className="mt-50 rounded-full bg-blue-600 px-14 py-5 text-lg text-white shadow-lg font-semibold text-center hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-500">Delete</a>
                            </div>

                        </div>
                    );
                }

                click = () => {
                     console.log(this.state.isEditting)
                     this.setState((state) => ({
                         ...state,
                         isEditting: !state.isEditting
                     }));
                }
            }

            function App() {
                return (
                    <div>
                        <Entry name="Entry" itemdata={data}/>
                    </div>
                )
            }

            ReactDOM.render(<App/>, rootElement)
        </script>
    </main>
{% endblock %}